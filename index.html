<html>
	<head>
		<title>Telerobotics Workshop with SPIKE Prime and Raspberry Pi + PiHat</title>
    
		<!-- Tufts CEEO's ServiceDock -->
		<script src='https://cdn.jsdelivr.net/gh/tuftsceeo/SPIKE-Web-Interface@1.1.2/cdn/ServiceDock.min.js'></script>
		<!-- ACE Browser-Based IDE API -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.min.js'></script>
    <!-- Send / Recieve Webpages --> 
    <script src="./SendWebpage.js"></script>
    <script src="./airtableBrowser.js"></script>
    <script src="./RecieveWebpage.js"></script>
    <script src="./tabfunctions.js"></script>
      
    <style>
      body {font-family: Arial;}
      .editor {
        border: 1px black solid;
          position: relative;
          left: 10px;
          height: 300px;
          width: 700px;
      }
      .instructions {
        padding: 5px;
        background-color: lightyellow;
      }
      .activities {
        background-color: lightgreen;
        padding: 5px;
      }
          
      .steps {
        background-color: lightgreen;
        padding: 5px;
      }

      /* Style the tab */
      .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
      }
      
      /* Style the buttons inside the tab */
      .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
      }
      
      /* Change background color of buttons on hover */
      .tab button:hover {
        background-color: #ddd;
      }
      
      /* Create an active/current tablink class */
      .tab button.active {
        background-color: #ccc;
      }
      
      /* Style the tab content */
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
      }

      /* Style buttons */
      .btn {
        background-color: Black;
        border: none;
        /* Remove borders */
        color: white;
        /* White text */
        font-size: 16px;
        /* Set a font size */
        cursor: pointer;
        /* Mouse pointer on hover */
        display: inline-block;
      }
  
      /* Darker background on mouse-over */
      .btn1:hover {
        background-color: blueviolet;
      }
  
      .btn2:hover {
        background-color: maroon;
      }
  
      .btn1 {
        border-radius: 10%;
      }
    
    </style>
	</head>
  
	<body>
		<br>
		<h1 align=center>Telerobotics Workshop with SPIKE Prime and Raspberry Pi + PiHat</h1>
		<p align=center>An introductory workshop by <b>Chris Rogers </b> with <b>Anna Quiros</b> and <b> Julia Zelevinsky</b> in collaboration with <b>MTA (Modern Teaching Aids) Australia</b></p>
    
		<p align=center><img src='./resources/telerobotics.jpg' height=300 width=650/></p>
		<hr />

		<!-- SPIKE Prime Service Doc -->
		<div style="position: fixed; top: 15px; right: 15px;" align=center>
			<small>
				<em>Using Chrome?</em><br />
				Connect to SPIKE here!<br />
			</small>
			<service-spike id="service_SPIKE" ></service-spike>
		</div>

		<h2>Quick Links</h2>
		<ul>
			<li><a href='https://docs.google.com/presentation/d/1_jNhGQl1TCdumMjjGHFXvGtqN1pefVhNZiqCfg6AGAw/edit?usp=sharingf'>Hackathon 07.12 Slides</a></li>
			<li><a href="https://airtable.com/">Airtable</a></li>
      <li><a href="https://docs.google.com/document/d/1-lBXxY9SRxkj5YPd5eincCnfen9G5I4S5P0lEUazADA/edit?usp=sharing">Airtable Setup Documentation</a></li>
      <li><a href="https://pyairtable.readthedocs.io/en/latest/api.html#overview"> PyAirtable documentation</li>
      <li><a href='https://education.lego.com/en-us/downloads/spike-app/software' target=_blank>LEGO Education's SPIKE App Software</a> (you can reference the documentation in this for the RasPi functions)</li> 
				<ul><li>Beta: <a href='https://spike.legoeducation.com' target=_blank>Web App version</a></li></ul>
			<li><a href='https://tufts-cr-for-lego.codingrooms.com/documentation/spike_prime_python_knowledge_base' target=_blank>SPIKE Prime Python Knowledge Base</a> (webpage)</li>
      <li><a href="https://tuftsceeo.github.io/SPIKE-Web-Interface/Service_SPIKE.html">Documentation on coding SPIKE Prime using Service Dock </a></li>
			      <li><a href="https://docs.google.com/document/d/1bWlIYHKdjSZctIOqjHUgA2ZHfszzGDCeKqzPdymRSyc/edit?usp=sharing">RasPi for telerobotics quick cheat sheet</a></li>
		</ul>
		
<!-- 		<hr />
		<h2>While you are waiting...</h2>
		<ul>
			<li><a href='./resources/SPIKEPrimeMTAbot.pdf' target=_blank>Build the MTA Bot</a></li>
			<li>Make sure all your cables are secure on your MTA Bot!</li>
		</ul>
		<div align=center>
			<img src='./resources/cable_management.png' width='600px' /><br />
			<p><small>Try to ensure no cables stick out beyond the width of the wheels...</small></p>
		</div> -->
		
<!-- 		<hr />
		<h2>Workshop Agenda</h2>
		<ul>
			<li><a href='#workshop'>Workshop Introduction</a> (including: Dr. E's use of SPIKE Prime to teach introduction to engineering)</li>
			<li><a href='#ml'>Introduction to Machine Learning (ML)</a></li>
			<li><a href='#supervised'>Supervised Learning Overview</a></li>
				<ul><li>Hands-On: <a href='#training1'>training Supervised Classification</a></li></ul>
			<li><a href='#unsupervised'>Unsupervised Learning Overview</a></li>
			<li><a href='#reinforcement'>Reinforcement Learning Overview</a></li>
				<ul><li>Hands-On: <a href='#training2'>training Q-Learning</a></li></ul>
			<li><a href='#next'>Next Steps and Further Exploration</a></li>
		</ul> -->

<!---------------------------- FEEDBACK ----------------------------->
		<hr />
		<a name='feedback'></a>
		<h2> <mark> Hackathon Feedback </mark></h2>
    Please open this form and <b> fill it out as you do the hackathon.</b> One submission per group! (Unless you really want to be extra and submit two, but you do you!) <br>
    <a href='https://docs.google.com/forms/d/e/1FAIpQLSfZRTpGSPWYKnfPzmZx83BKEXZShvW73QSIwHYz4kl7sghbzQ/viewform?usp=sf_link'> GOOGLE FORMS LINK</a>

    <br>
    <br>

    
<!-----------------------------  INTRO TO TELEROBOTICS ----------------------------->
		<hr />
    <a name='intro'></a>
		<h2>A Quick Overview of Telerobotics</h2>

    Click on a tab to learn more! <br> <br> 

    <mark>HACKATHON TASK:</mark> Read through these tabs, and <b>write down one or two comments / confusions </b> you have. Or, let us know if you have none. Please <b> read / watch ONE of the articles / videos (we will assign them) </b> and <b> answer </b>: Do you think the article / video that you interacted with was relevant? Helpful? Informative? etc. <i> (or at least, ya know, skim the article / video... don't take too much time on this) </i> Do you know of another cool real-world example of telerobotics?<br> <br> 


    <div class="tab">
      <button class="tablinks" onclick="openCity(event, 'whatAreTelerobots')">What are Telerobots?</button>
      <button class="tablinks" onclick="openCity(event, 'airtableIntro')">What is Airtable?</button>
      <button class="tablinks" onclick="openCity(event, 'real-worldExamples')">Real-World Examples</button>
    </div>

    <div id="whatAreTelerobots" class="tabcontent"> <br>
      At the most basic level, telerobots are remotely controlled robots. <br><br>In this workshop, we want to demonstrate the process of building, coding, connecting telerobots over long distances. The telerobots will be either a SPIKE Prime or a Raspberry Pi 4 with a PiHat (using SPIKE Prime motors, sensors, etc.). To communicate, one person will send commands to Airtable (described in the next tab), and these commands will be read by a receiving source that reads the commands and runs the corresponding action to the command. <br> <br>
    </div>

    <div id="airtableIntro" class="tabcontent">
      <br>
      <a href="https://airtable.com/">Airtable</a> lets you create a <b>base</b> which holds all of your tables. Tables are like spreadsheets that you can update from anywhere, and they can hold all sorts of values, like numbers, strings, and dates! Inside a table, there are <b>fields.</b> Each field has a <b>datatype</b> assigned to it, so numbers can only go in number fields, and so on. Your robot will <b>read</b> your Airtable and <b>act</b> based on the data that you <b>write</b> to it. <br>

      <p align=center><img src='./resources/AirTableDiagram.jpg' height=300 width=450/></p>

      In our examples, we use Airtable to allow our computers and robots to write and receive commands (respectively) over long distances. We post commands to Airtable that a receiving robot or computer subscribes to, interprets, and translates into the corresponding action. <br> <br>

      <i>Based on documentation originally written by Dr. Ethan Danahy <br>
      <a href="http://dreslab.com/">Dr.E's Lab</a></i>
      <br>
      <br>

    </div>
    
    <div id="real-worldExamples" class="tabcontent">
      <br>
      <!-- Cancer Patients -->
      <a href="https://www.mdanderson.org/cancerwise/pediatric-cancer-patients-connect-through-a-robot.h00-159143667.html">Pediatric cancer patients connect through a robot</a> <br>
      An article about young cancer patients using telerobots to attend school and their friends. 
      <br> 
      <br>
      <br>
      
      The Future of Remote Work is in Telerobotics <br>
  			<blockquote><iframe width="560" height="315" src="https://www.youtube.com/embed/V-iJqbuJKUg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></blockquote> <br> 
  
      Tactile Telerobot <br>
      <blockquote><iframe width="560" height="315" src="https://www.youtube.com/embed/R-sP_pju81E" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></blockquote> <br> 
  
      Robocath_First telerobotic procedure in Europe <br>
      <blockquote><iframe width="560" height="315" src="https://www.youtube.com/embed/2k8WR7eE81c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe></blockquote>
      <br>
      <br>
    </div>

  <br>


    
<!---------------------------- BUILD YOUR ROBOT ----------------------------->
    <hr />
		<a name='build_robot'></a>
		<h2>Build Your Robot</h2>

    <p><mark>HACKATHON TASK:</mark> We want your photos here!! Please upload (good) photos of your robot at the end of the hackathon. <br>
    <br>
    <br>

    <b> When you're building, think about... </b> <br>
    <mark>HACKATHON TASK:</mark> Come up with one (or more) questions / ideas to inspire or challenge robot builders

    </p>




    
<!---------------------------- CODE ----------------------------->
		<hr />
		<a name='code'></a>
		<h2>Code Your Robot </h2>
    
    <b> Already have ideas? Go for it!! </b> <br>
    We want to do this in as many ways as possible. So please-- do something different than us! <br>
    <br> 
    <b> Need some guidance?</b> <br>
    We've set up an <a href="https://airtable.com/shr34H7Mv2rENspvq">Airtable</a> where each robot has a little "mailbox" for commands. The mailbox is identified by a <b> unique </b> ID. To move the correct robot, please make sure you send your movement commands to the <b> correct "mailbox". </b> We will assign you mailboxes!
      <br> 
      <br> 
      Grab a partner and work together to send and recieve commands on your robot. Use the displays below to do so! And let us know if you have any questions / concerns. 
      <br> 
      <br> 
    
    <p>
      <h3 class='steps'>SENDING MOVEMENT INFORMATION</h3> 
      
      
      <p style="text-align:center;">
        <label for="robotNumberSend">I want to control Robot #</label>
        <input type="number" id="robotNumberSend" name="robotNumberSend"><br><br>
      </p>
      
      <p style="text-align:center;">
          <button class="btn btn1" onclick="update_airtable('forward');">Forward</button> 
          <br> <br>
          <button class="btn btn1" onclick="update_airtable('left');"> Left </button>
          </button>
          <button class="btn btn1" onclick="update_airtable('rotate180');"> Rotate 180 </button>
          <button class="btn btn1" onclick="update_airtable('right');"> Right </button>
          <br> <br>
          <button class="btn btn1" onclick="update_airtable('backward');"> Backward </button>
    
          <br> <br> <br> <br>
          These action buttons don't do anything at the moment. Copy the code below into your own editor to add your own actions! <br> <br> 
          <button class="btn btn2" onclick="update_airtable('action1');"> Action 1 </button>
          <button class="btn btn2" onclick="update_airtable('action2');"> Action 2 </button>
<!--     <br> <br> <br> <br> 
          <button class="btn btn2" onclick="update_airtable('no_command');"> No Command </button> -->
        </p>
      <br>
      <br> 
    
      Want to set up your own airtable? Follow <a href="https://docs.google.com/document/d/1-lBXxY9SRxkj5YPd5eincCnfen9G5I4S5P0lEUazADA/edit?usp=sharing">this Airtable set-up documentation</a>. 
      <br> <br>
      Want to play around with this code that sends the commands to Airtable? Here's the 
      <a href="https://gist.github.com/JuliaZel/4f72230397b0cd8972c8f24bd8a8aede">GitHub link!</a>

    </p>

    <h3 class='steps'>RECEIVING MOVEMENT INFORMATION</h3> 

    Are you using SPIKE Prime or Raspberry Pi + PiHat?  <br> <br> 
    
    <div class="tab">
      <button class="tablinks" onclick="openCity(event, 'SPIKE')">SPIKE Prime</button>
      <button class="tablinks" onclick="openCity(event, 'RasPi')">Raspberry Pi + PiHat</button>
    </div>
    
    <div id="SPIKE" class="tabcontent">
      <h3>SPIKE Prime</h3>
        
      
      To receive the correct movement commands: <br>
        <ul>
			    <li> Make sure you subscribe to the <b> correct "mailbox" number. </b> </li>
          <li> Click on the <b>SPIKE Prime ServiceDock</b> icon in the upper right-hand corner of the page. Select the port your robot is connected to. Once the circle turns from red to green, you're good to go! If you're having issues connecting, make sure you're closed out of any other SPIKE Prime-related software. ServiceDock can't compete with all that. :( </li>
          <li> The robot may take a second to register the first command. If it doesn't work after a couple seconds, though, please let us know!</li>
        </ul>
          <br>
        <p style="text-align:center;">
          <label for="robotNumberSubscribe">I want to subscribe to Robot #</label>
          <input type="number" id="robotNumberSubscribe" name="robotNumberSubscribe"><br><br>
        </p>
      <br>
      Want to play around with this code? Here's the <a href="https://gist.github.com/JuliaZel/f301178f880be305549e1c1530bcaf55">GitHub Link!</a>
      <br>
      
      <b>Activity Extensions</b> <br>
      <mark>HACKATHON TASK:</mark> Come up with one (or more) questions / ideas to inspire or challenge coders. Also, was there anything confusing about our current structure? 
      <br>
      <br>
    </div>
    
    <div id="RasPi" class="tabcontent">
      <h3>Raspberry Pi + PiHat</h3>
      To receive the correct movement commands, make sure you: <br> 
      <ul> 
        <li><b>Download</b> <a href= "https://gist.github.com/JuliaZel/e86048f01efe50742e8f4ac06a9933ff"> this python file </a> to your RasPi 
        <li><b>Import</b> the correct libraries (noted in the code)</li>
        <li><b>Update the code </b> so that it matches your "mailbox" name and Robot ID </li>
      </ul>
      <br>
    <a href="https://docs.google.com/document/d/1bWlIYHKdjSZctIOqjHUgA2ZHfszzGDCeKqzPdymRSyc/edit?usp=sharing">RasPi for telerobotics quick cheat sheet</a>
    <br> <br>
    
      <b>Activity Extensions</b> <br>
      <mark>HACKATHON TASK:</mark> Come up with one (or more) questions / ideas to inspire or challenge coders. Also, was there anything confusing about our current structure? 
      <br>
      <br>
    </div>

<br>


<!---------------------------- SPECIAL THANKS ----------------------------->
    <hr />
		<h2>Special Thanks to:</h2>
		<p>Ethan Danahy, James Dwyer, and Gabriel Sessions</p>
		<p>Workshop designed and developed by:</p>
		<p align=center><a href='https://ceeo.tufts.edu' target=_blank><img src='./resources/ceeo.png' height='100px' border=0 /></a></p>
		<p align=center><a href='https://www.teaching.com.au/' target=_blank><img src='./resources/mta.png'  height='100px' border=0 /></a></p>
		<p align=center><small>Content is Copyright 2022 by Chris Rogers</small></p>
		<p align=center><small>LEGO®, the LEGO® logo, the Brick, SPIKE™, and the Minifigure are trademarks of ©The LEGO® Group.<br />All other trademarks and copyrights are the property of their respective owners. All rights reserved.<br />This workshop and content isn’t affiliated, authorized, or endorsed by The LEGO Group.</small></p>
	</body>
              
	<!-- scripts that make this page run... -->
	<script lang='javascript'>

    setInterval(listener, 650);
    
		/* interactive functions */
		function downloadandexecute(editor_num) {
			console.log(editor_num);
			editor_num_str = editor_num.toString();
			editor_ptr = editor_list[editor_num];
			select_element = document.getElementById("slot" + editor_num_str);
			slot_num = parseInt(select_element.options[select_element.options.selectedIndex].value);
			slot_name = document.getElementById("name" + editor_num_str).value;
            
            // stop any currently running program
            mySPIKE.stopCurrentProgram();
            
            // get text content with Ace.js API
            var editSession = editor_ptr.getSession();
            var codeSession = editSession.getValue();

            // write program to brick
            mySPIKE.writeProgram(slot_name, codeSession, slot_num, async function () {
                // execute program
                mySPIKE.executeProgram(slot_num);
            });
		}
		function download(editor_num) {
			console.log(editor_num);
			editor_num_str = editor_num.toString();
			editor_ptr = editor_list[editor_num];
			select_element = document.getElementById("slot" + editor_num_str)
			slot_num = parseInt(select_element.options[select_element.options.selectedIndex].value);
			slot_name = document.getElementById("name" + editor_num_str).value;

            // stop any currently running program
            mySPIKE.stopCurrentProgram();

            // get text content with Ace.js API
            var editSession = editor_ptr.getSession();
            var codeSession = editSession.getValue();
				
            // write program to brick
            mySPIKE.writeProgram("ML_Activity", codeSession, slot_num, async function () {
                // stop any currently running program
                mySPIKE.stopCurrentProgram();
            });
		}
		function execute(editor_num) {
			select_element = document.getElementById("slot" + editor_num_str)
			slot_num = parseInt(select_element.options[select_element.options.selectedIndex].value);
            mySPIKE.stopCurrentProgram();
            mySPIKE.executeProgram(slot_num);
		}
		function stop(editor_num) {
			mySPIKE.stopCurrentProgram();
		}

		/* global objects */
        var mySPIKE = document.getElementById("service_SPIKE").getService();
        var editor_list = new Array();
        var editor_num = 0;
        while (document.getElementById('editor' + editor_num.toString()) != null) {
	        editor_num_str = editor_num.toString();
			editor_list.push(ace.edit("editor" + editor_num_str));
			var button = null;
			button = document.getElementById("downloadandexecute" + editor_num_str);
			button.addEventListener("click", downloadandexecute.bind(null, editor_num));
			button = document.getElementById("download" + editor_num_str);
			button.addEventListener("click", download.bind(null, editor_num));
			button = document.getElementById("execute" + editor_num_str);
			button.addEventListener("click", execute.bind(null, editor_num));
			button = document.getElementById("stop" + editor_num_str);
			button.addEventListener("click", stop.bind(null, editor_num));
	        editor_num++;
        }
	</script> 
</html>
